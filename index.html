<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catholic Script Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#2563eb">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Catholic Script Generator">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>‚úùÔ∏è</text></svg>">
    <link rel="manifest" href="manifest.json">
    
    <style>
        .form-field {
            margin-bottom: 1.5rem;
        }
        .form-label {
            display: flex;
            align-items: center;
            font-size: 0.875rem;
            font-weight: 500;
            color: #374151;
            margin-bottom: 0.5rem;
        }
        .form-input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            font-size: 1rem;
        }
        .form-input:focus {
            outline: none;
            ring: 2px;
            ring-color: #3b82f6;
            border-color: transparent;
        }
        .btn-primary {
            width: 100%;
            background-color: #2563eb;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.375rem;
            border: none;
            font-size: 1rem;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .btn-primary:hover {
            background-color: #1d4ed8;
        }
        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .hidden {
            display: none;
        }
        .script-output {
            white-space: pre-wrap;
            font-family: monospace;
            font-size: 0.875rem;
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            padding: 1rem;
            max-height: 24rem;
            overflow-y: auto;
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4">
    <div class="max-w-2xl mx-auto">
        <div id="form-container" class="bg-white rounded-lg shadow-lg p-6">
            <div class="text-center mb-8">
                <h1 class="text-3xl font-bold text-gray-800 mb-2">
                    Catholic Script Generator
                </h1>
                <p class="text-gray-600">
                    Create engaging Catholic content scripts faithful to Church teaching
                </p>
            </div>

            <div class="form-field">
                <label class="form-label">
                    üìÑ Topic *
                </label>
                <input type="text" id="topic" class="form-input" placeholder="e.g., The Miracle of Fatima, Saint Francis of Assisi, The Eucharist" required>
            </div>

            <div class="form-field">
                <label class="form-label">
                    üéØ Goal/Purpose *
                </label>
                <textarea id="goal" class="form-input" rows="3" placeholder="e.g., Educate viewers about the apparitions, Inspire devotion to prayer" required></textarea>
            </div>

            <div class="form-field">
                <label class="form-label">
                    üë• Target Audience *
                </label>
                <input type="text" id="targetAudience" class="form-input" placeholder="e.g., Young Catholics, Curious non-Catholics, Families" required>
            </div>

            <div class="form-field">
                <label class="form-label">
                    üí¨ Tone/Style *
                </label>
                <input type="text" id="tone" class="form-input" placeholder="e.g., Reverent but engaging, Educational and inspiring, Conversational" required>
            </div>

            <div class="form-field">
                <label class="form-label">
                    ‚è∞ Duration *
                </label>
                <input type="text" id="duration" class="form-input" placeholder="e.g., 3-4 minutes, 5 minutes, 2 minutes" required>
            </div>

            <div class="form-field">
                <label class="form-label">
                    ‚ûï Key Points to Include *
                </label>
                <textarea id="keyPoints" class="form-input" rows="3" placeholder="e.g., Historical context, specific miracles, Church approval, key teachings" required></textarea>
            </div>

            <div class="form-field">
                <label class="form-label">
                    üéØ Call to Action
                </label>
                <input type="text" id="callToAction" class="form-input" placeholder="e.g., Encourage daily rosary, Visit a shrine, Deepen prayer life">
            </div>

            <div class="form-field">
                <label class="form-label">
                    üëÅÔ∏è Visual Style
                </label>
                <textarea id="visualStyle" class="form-input" rows="3" placeholder="e.g., Historical reenactment with talking head, Graphics and animations, Location shots"></textarea>
            </div>

            <div class="form-field">
                <label class="form-label">
                    üìù Additional Notes
                </label>
                <textarea id="additionalNotes" class="form-input" rows="3" placeholder="Any specific requirements, sources to reference, or special considerations"></textarea>
            </div>

            <button id="generateBtn" class="btn-primary">
                üé¨ Generate Catholic Script
            </button>
            
            <!-- Debug button - remove this after testing -->
            <button id="testBtn" class="btn-primary mt-2" style="background-color: #059669;">
                üîß Test Button (Click to verify JavaScript is working)
            </button>

            <div class="mt-6 p-4 bg-blue-50 rounded-lg">
                <h3 class="font-semibold text-blue-800 mb-2">
                    ‚úùÔ∏è Faithful to Church Teaching
                </h3>
                <p class="text-sm text-blue-700">
                    All generated scripts are designed to be faithful to Catholic Church teaching and approved by the Magisterium. 
                    Always review content with your spiritual director or parish priest before publication.
                </p>
            </div>
        </div>

        <div id="script-container" class="bg-white rounded-lg shadow-lg p-6 hidden">
            <div class="flex items-center justify-between mb-6">
                <h1 class="text-2xl font-bold text-gray-800">
                    üìÑ Generated Catholic Script
                </h1>
                <button id="newScriptBtn" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700">
                    Create New Script
                </button>
            </div>
            
            <div id="script-info" class="bg-gray-50 rounded-lg p-4 mb-4">
                <h3 id="script-topic" class="font-semibold text-gray-700 mb-2"></h3>
                <p id="script-goal" class="text-sm text-gray-600"></p>
            </div>
            
            <div class="prose max-w-none">
                <div id="script-output" class="script-output"></div>
            </div>
        </div>
    </div>

    <script>
        // Simple form handling without external dependencies
        const formContainer = document.getElementById('form-container');
        const scriptContainer = document.getElementById('script-container');
        const generateBtn = document.getElementById('generateBtn');
        const newScriptBtn = document.getElementById('newScriptBtn');
        const testBtn = document.getElementById('testBtn');

        // Test button to verify JavaScript is working
        testBtn.addEventListener('click', function() {
            alert('JavaScript is working! The generate button should work now.');
            console.log('Test button clicked - JavaScript is functioning');
        });

        // Mock Claude API function
        async function generateScript() {
            const topic = document.getElementById('topic').value;
            const goal = document.getElementById('goal').value;
            const targetAudience = document.getElementById('targetAudience').value;
            const tone = document.getElementById('tone').value;
            const duration = document.getElementById('duration').value;
            const keyPoints = document.getElementById('keyPoints').value;
            const callToAction = document.getElementById('callToAction').value;
            const visualStyle = document.getElementById('visualStyle').value;
            const additionalNotes = document.getElementById('additionalNotes').value;

            // Simulate API delay
            await new Promise(resolve => setTimeout(resolve, 2000));

            return `| AUDIO | VISUAL |
|-------|--------|
| Welcome to today's exploration of ${topic}. As Catholics, we are called to understand and appreciate the rich traditions of our faith. | + Opening shot of presenter in study with Catholic books and religious art |
| Today we're diving into this incredible aspect of our Catholic heritage that has touched millions of lives throughout history. | + Cut to talking head |
| ${goal} This is what we hope to accomplish together in the next ${duration}. | + Graphics showing key themes |
| Our target audience today includes ${targetAudience}, and we'll maintain a ${tone} approach throughout. | + Cut to talking head |
| Let's explore the key elements: ${keyPoints} | + Historical footage/images related to topic |
| ${visualStyle ? 'Visually, we'll present this through: ' + visualStyle : 'We'll use engaging visuals to support our message.'} | + Appropriate visual style as described |
| The Church has always emphasized the importance of understanding our faith deeply and authentically. | + Images of Church documents/Magisterium |
| This teaching is rooted in Scripture and Tradition, passed down through the apostolic succession. | + Cut to talking head |
| As we conclude, let us remember that our faith is not just about knowledge, but about living out these truths in our daily lives. | + Montage of Catholic life/prayer/community |
| ${callToAction || 'I encourage you to reflect on how this applies to your own spiritual journey.'} | + Closing shot with call-to-action text overlay |
| May God bless you on this journey of faith. Until next time, peace be with you. | + Final presenter shot with blessing gesture |

*This is a sample script structure. For actual production, each segment would be expanded to reach approximately 500 words total with detailed visual directions and Catholic theological accuracy.*

Additional Notes: ${additionalNotes}`;
        }

        generateBtn.addEventListener('click', async function() {
            console.log('Generate button clicked!'); // Debug log
            
            // Validate required fields
            const requiredFields = ['topic', 'goal', 'targetAudience', 'tone', 'duration', 'keyPoints'];
            let isValid = true;
            
            for (const field of requiredFields) {
                const input = document.getElementById(field);
                if (!input.value.trim()) {
                    input.style.borderColor = '#ef4444';
                    isValid = false;
                    console.log(`Field ${field} is empty`); // Debug log
                } else {
                    input.style.borderColor = '#d1d5db';
                }
            }

            if (!isValid) {
                alert('Please fill in all required fields (marked with *)');
                return;
            }

            console.log('Validation passed, generating script...'); // Debug log

            // Show loading state immediately
            generateBtn.innerHTML = '‚è≥ Generating Script...';
            generateBtn.disabled = true;
            generateBtn.style.backgroundColor = '#9ca3af';

            try {
                console.log('Calling generateScript function...'); // Debug log
                const script = await generateScript();
                console.log('Script generated successfully'); // Debug log
                
                // Update script display
                document.getElementById('script-topic').textContent = `Script Topic: ${document.getElementById('topic').value}`;
                document.getElementById('script-goal').textContent = `Goal: ${document.getElementById('goal').value}`;
                document.getElementById('script-output').textContent = script;
                
                console.log('Updated script display, switching views...'); // Debug log
                
                // Show script, hide form
                formContainer.classList.add('hidden');
                scriptContainer.classList.remove('hidden');
                
                console.log('Views switched successfully'); // Debug log
            } catch (error) {
                console.error('Error in generateScript:', error); // Debug log
                alert('Error generating script: ' + error.message);
            } finally {
                // Reset button state
                generateBtn.innerHTML = 'üé¨ Generate Catholic Script';
                generateBtn.disabled = false;
                generateBtn.style.backgroundColor = '#2563eb';
                console.log('Button state reset'); // Debug log
            }
        });

        newScriptBtn.addEventListener('click', function() {
            // Show form, hide script
            scriptContainer.classList.add('hidden');
            formContainer.classList.remove('hidden');
            
            // Reset form
            document.querySelectorAll('input, textarea').forEach(input => {
                input.value = '';
                input.style.borderColor = '#d1d5db';
            });
        });

        // Add to home screen prompt for PWA
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            deferredPrompt = e;
        });
    </script>
</body>
</html>
